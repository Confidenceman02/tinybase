var e,s;e=this,s=function(e,s){"use strict";const t=e=>typeof e,o="",r=t(o),u="Listener",d="Result",l="Ids",n="Table",i=n+"s",a=n+l,c="Row",I=c+"Count",C=c+l,p="Sorted"+c+l,w="Cell",b=w+l,R="Value",k=R+"s",g=R+l,h=e=>null==e,m=(e,s,t)=>h(e)?t?.():s(e),L=e=>t(e)==r,y=()=>{},S=(e,s)=>e.map(s),V=Object.keys,{createContext:T,useContext:f}=s,x=T([]),v=(e,s)=>{const t=f(x);return h(e)?t[s]:L(e)?((e,s)=>m(e,(e=>e[s])))(t[s+1]??{},e):e},P=(e,s)=>{const t=v(e,s);return h(e)||L(e)?t:e},q=e=>V(f(x)[e]??{}),B=e=>P(e,0),M=e=>P(e,2),D=e=>P(e,4),F=e=>P(e,6),O=e=>P(e,8),Q=e=>P(e,10),E=e=>e.toLowerCase();E(u);const A="Transaction";E(A);const{useCallback:G,useEffect:j,useMemo:U,useLayoutEffect:W,useRef:z,useState:H}=s,J=[],K={},N=[[],void 0,[]],X=(e,s,t=J)=>{const o=U((()=>s(e)),[e,...t]);return j((()=>()=>o.destroy()),[o]),o},Y=(e,s,t,o=J,r)=>{const[,u]=H(),d=G((()=>s?.["get"+e]?.(...o)??t),[s,e,...o,t]),l=z();return U((()=>l.current=d()),[d]),Z(e,s,((...e)=>{l.current=h(r)?d():e[r],u([])}),[d,r],o),l.current},Z=(e,s,t,o=J,r=J,...d)=>W((()=>{const o=s?.["add"+e+u]?.(...r,t,...d);return()=>s?.delListener(o)}),[s,e,...r,...o,...d]),$=(e,s,t,o=J,r=y,u=J,...d)=>{const l=B(e);return G((e=>m(l,(o=>m(t(e,o),(e=>r(o["set"+s](...d,e),e)))))),[l,s,...o,...u,...d])},_=(e,s,t=y,o=J,...r)=>{const u=B(e);return G((()=>t(u?.["del"+s](...r))),[u,s,...o,...r])},ee=(e,s,t)=>{const o=Q(e);return G((()=>o?.[s](t)),[o,s,t])},se=e=>Y(a,B(e),J),te=(e,s)=>Y(C,B(s),J,[e]),oe=(e,s,t,o=0,r,u)=>Y(p,B(u),J,[e,s,t,o,r],6),re=(e,s,t)=>Y(b,B(t),J,[e,s]),ue=(e,s,t,o)=>Y(w,B(o),void 0,[e,s,t],4),de=e=>Y(g,B(e),J),le=(e,s)=>Y(R,B(s),void 0,[e]),ne=(e,s)=>Y("Metric",M(s),void 0,[e]),ie=(e,s)=>Y("SliceIds",D(s),J,[e]),ae=(e,s,t)=>Y("Slice"+C,D(t),J,[e,s]),ce=(e,s,t)=>Y("RemoteRowId",F(t),void 0,[e,s]),Ie=(e,s,t)=>Y("Local"+C,F(t),J,[e,s]),Ce=(e,s,t)=>Y("Linked"+C,F(t),J,[e,s]),pe=(e,s)=>Y(d+C,O(s),J,[e]),we=(e,s,t,o=0,r,u)=>Y(d+p,O(u),J,[e,s,t,o,r],6),be=(e,s,t)=>Y(d+b,O(t),J,[e,s]),Re=(e,s,t,o)=>Y(d+w,O(o),void 0,[e,s,t]),ke=e=>Y("CheckpointIds",Q(e),N),ge=(e,s)=>Y("Checkpoint",Q(s),void 0,[e]),he=e=>ee(e,"goBackward"),me=e=>ee(e,"goForward"),{PureComponent:Le,Fragment:ye,createElement:Se,useCallback:Ve,useLayoutEffect:Te,useRef:fe,useState:xe}=s,ve=(e,...s)=>h(e)?{}:e(...s),Pe=(e,s)=>[e,e?.getStore(),e?.getLocalTableId(s),e?.getRemoteTableId(s)],{useMemo:qe}=s,Be=({tableId:e,store:s,rowComponent:t=Ee,getRowComponentProps:o,customCellIds:r,separator:u,debugIds:d},l)=>Oe(S(l,(u=>Se(t,{...ve(o,u),key:u,tableId:e,rowId:u,customCellIds:r,store:s,debugIds:d}))),u,d,e),Me=({queryId:e,queries:s,resultRowComponent:t=We,getResultRowComponentProps:o,separator:r,debugIds:u},d)=>Oe(S(d,(r=>Se(t,{...ve(o,r),key:r,queryId:e,rowId:r,queries:s,debugIds:u}))),r,u,e),De=({relationshipId:e,relationships:s,rowComponent:t=Ee,getRowComponentProps:o,separator:r,debugIds:u},d,l)=>{const[n,i,a]=Pe(F(s),e),c=d(e,l,n);return Oe(S(c,(e=>Se(t,{...ve(o,e),key:e,tableId:a,rowId:e,store:i,debugIds:u}))),r,u,l)},Fe=e=>({checkpoints:s,checkpointComponent:t=ze,getCheckpointComponentProps:o,separator:r,debugIds:u})=>{const d=Q(s);return Oe(S(e(ke(d)),(e=>Se(t,{...ve(o,e),key:e,checkpoints:d,checkpointId:e,debugIds:u}))),r)},Oe=(e,s,t,o)=>{const r=h(s)||!Array.isArray(e)?e:S(e,((e,t)=>t>0?[s,e]:e));return t?[o,":{",r,"}"]:r},Qe=({tableId:e,rowId:s,cellId:t,store:r,debugIds:u})=>Oe(o+(ue(e,s,t,r)??o),void 0,u,t),Ee=({tableId:e,rowId:s,store:t,cellComponent:o=Qe,getCellComponentProps:r,customCellIds:u,separator:d,debugIds:l})=>Oe(S(((e,s,t,o)=>{const r=re(s,t,o);return e??r})(u,e,s,t),(u=>Se(o,{...ve(r,u),key:u,tableId:e,rowId:s,cellId:u,store:t,debugIds:l}))),d,l,s),Ae=e=>Be(e,te(e.tableId,e.store)),Ge=({valueId:e,store:s,debugIds:t})=>Oe(o+(le(e,s)??o),void 0,t,e),je=({indexId:e,sliceId:s,indexes:t,rowComponent:o=Ee,getRowComponentProps:r,separator:u,debugIds:d})=>{const[l,n,i]=((e,s)=>[e,e?.getStore(),e?.getTableId(s)])(D(t),e),a=ae(e,s,l);return Oe(S(a,(e=>Se(o,{...ve(r,e),key:e,tableId:i,rowId:e,store:n,debugIds:d}))),u,d,s)},Ue=({queryId:e,rowId:s,cellId:t,queries:r,debugIds:u})=>Oe(o+(Re(e,s,t,r)??o),void 0,u,t),We=({queryId:e,rowId:s,queries:t,resultCellComponent:o=Ue,getResultCellComponentProps:r,separator:u,debugIds:d})=>Oe(S(be(e,s,t),(u=>Se(o,{...ve(r,u),key:u,queryId:e,rowId:s,cellId:u,queries:t,debugIds:d}))),u,d,s),ze=({checkpoints:e,checkpointId:s,debugIds:t})=>Oe(ge(s,e)??o,void 0,t,s),He=Fe((e=>e[0])),Je=Fe((e=>h(e[1])?[]:[e[1]])),Ke=Fe((e=>e[2]));e.BackwardCheckpointsView=He,e.CellView=Qe,e.CheckpointView=ze,e.CurrentCheckpointView=Je,e.ForwardCheckpointsView=Ke,e.IndexView=({indexId:e,indexes:s,sliceComponent:t=je,getSliceComponentProps:o,separator:r,debugIds:u})=>Oe(S(ie(e,s),(r=>Se(t,{...ve(o,r),key:r,indexId:e,sliceId:r,indexes:s,debugIds:u}))),r,u,e),e.LinkedRowsView=e=>De(e,Ce,e.firstRowId),e.LocalRowsView=e=>De(e,Ie,e.remoteRowId),e.MetricView=({metricId:e,metrics:s,debugIds:t})=>Oe(ne(e,s)??o,void 0,t,e),e.Provider=({store:e,storesById:t,metrics:o,metricsById:r,indexes:u,indexesById:d,relationships:l,relationshipsById:n,queries:i,queriesById:a,checkpoints:c,checkpointsById:I,children:C})=>{const p=s.useContext(x);return Se(x.Provider,{value:qe((()=>[e??p[0],{...p[1],...t},o??p[2],{...p[3],...r},u??p[4],{...p[5],...d},l??p[6],{...p[7],...n},i??p[8],{...p[9],...a},c??p[10],{...p[11],...I}]),[e,t,o,r,u,d,l,n,i,a,c,I,p])},C)},e.RemoteRowView=({relationshipId:e,localRowId:s,relationships:t,rowComponent:o=Ee,getRowComponentProps:r,debugIds:u})=>{const[d,l,,n]=Pe(F(t),e),i=ce(e,s,d);return Oe(h(n)||h(i)?null:Se(o,{...ve(r,i),key:i,tableId:n,rowId:i,store:l,debugIds:u}),void 0,u,s)},e.ResultCellView=Ue,e.ResultRowView=We,e.ResultSortedTableView=({cellId:e,descending:s,offset:t,limit:o,...r})=>Me(r,we(r.queryId,e,s,t,o,r.queries)),e.ResultTableView=e=>Me(e,pe(e.queryId,e.queries)),e.RowView=Ee,e.SliceView=je,e.SortedTableView=({cellId:e,descending:s,offset:t,limit:o,...r})=>Be(r,oe(r.tableId,e,s,t,o,r.store)),e.TableView=Ae,e.TablesView=({store:e,tableComponent:s=Ae,getTableComponentProps:t,separator:o,debugIds:r})=>Oe(S(se(e),(o=>Se(s,{...ve(t,o),key:o,tableId:o,store:e,debugIds:r}))),o),e.ValueView=Ge,e.ValuesView=({store:e,valueComponent:s=Ge,getValueComponentProps:t,separator:o,debugIds:r})=>Oe(S(de(e),(o=>Se(s,{...ve(t,o),key:o,valueId:o,store:e,debugIds:r}))),o),e.useAddRowCallback=(e,s,t=J,o,r=y,u=J,d=!0)=>{const l=B(o);return G((t=>m(l,(o=>m(s(t,o),(s=>r(o.addRow(e,s,d),o,s)))))),[l,e,...t,...u,d])},e.useCell=ue,e.useCellIds=re,e.useCellIdsListener=(e,s,t,o,r,u)=>Z(b,B(u),t,o,[e,s],r),e.useCellListener=(e,s,t,o,r,u,d)=>Z(w,B(d),o,r,[e,s,t],u),e.useCheckpoint=ge,e.useCheckpointIds=ke,e.useCheckpointIdsListener=(e,s,t)=>Z("CheckpointIds",Q(t),e,s),e.useCheckpointListener=(e,s,t,o)=>Z("Checkpoint",Q(o),s,t,[e]),e.useCheckpoints=e=>v(e,10),e.useCheckpointsIds=()=>q(11),e.useCheckpointsOrCheckpointsById=Q,e.useCreateCheckpoints=(e,s,t)=>X(e,s,t),e.useCreateIndexes=(e,s,t)=>X(e,s,t),e.useCreateMetrics=(e,s,t)=>X(e,s,t),e.useCreatePersister=(e,s,t=J,o,r=J,u,d=J)=>{const[,l]=H(),n=U((()=>s(e)),[e,...t]);return j((()=>((async()=>{o&&(await o(n),l([]))})(),()=>{n?.destroy(),u?.(n)})),[n,...r,...d]),n},e.useCreateQueries=(e,s,t)=>X(e,s,t),e.useCreateRelationships=(e,s,t)=>X(e,s,t),e.useCreateStore=(e,s=J)=>U(e,s),e.useDelCellCallback=(e,s,t,o,r,u,d)=>_(r,w,u,d,e,s,t,o),e.useDelRowCallback=(e,s,t,o,r)=>_(t,c,o,r,e,s),e.useDelTableCallback=(e,s,t,o)=>_(s,n,t,o,e),e.useDelTablesCallback=(e,s,t)=>_(e,i,s,t),e.useDelValueCallback=(e,s,t,o)=>_(s,R,t,o,e),e.useDelValuesCallback=(e,s,t)=>_(e,k,s,t),e.useDidFinishTransactionListener=(e,s,t)=>Z("DidFinish"+A,B(t),e,s),e.useGoBackwardCallback=he,e.useGoForwardCallback=me,e.useGoToCallback=(e,s=J,t,o=y,r=J)=>{const u=Q(t);return G((s=>m(u,(t=>m(e(s),(e=>o(t.goTo(e),e)))))),[u,...s,...r])},e.useIndexIds=e=>Y("IndexIds",D(e),J),e.useIndexes=e=>v(e,4),e.useIndexesIds=()=>q(5),e.useIndexesOrIndexesById=D,e.useLinkedRowIds=Ce,e.useLinkedRowIdsListener=(e,s,t,o,r)=>Z("Linked"+C,F(r),t,o,[e,s]),e.useLocalRowIds=Ie,e.useLocalRowIdsListener=(e,s,t,o,r)=>Z("Local"+C,F(r),t,o,[e,s]),e.useMetric=ne,e.useMetricIds=e=>Y("MetricIds",M(e),J),e.useMetricListener=(e,s,t,o)=>Z("Metric",M(o),s,t,[e]),e.useMetrics=e=>v(e,2),e.useMetricsIds=()=>q(3),e.useMetricsOrMetricsById=M,e.useQueries=e=>v(e,8),e.useQueriesIds=()=>q(9),e.useQueriesOrQueriesById=O,e.useQueryIds=e=>Y("QueryIds",O(e),J),e.useRedoInformation=e=>{const s=Q(e),[,,[t]]=ke(s);return[!h(t),me(s),t,m(t,(e=>s?.getCheckpoint(e)))??o]},e.useRelationshipIds=e=>Y("RelationshipIds",F(e),J),e.useRelationships=e=>v(e,6),e.useRelationshipsIds=()=>q(7),e.useRelationshipsOrRelationshipsById=F,e.useRemoteRowId=ce,e.useRemoteRowIdListener=(e,s,t,o,r)=>Z("RemoteRowId",F(r),t,o,[e,s]),e.useResultCell=Re,e.useResultCellIds=be,e.useResultCellIdsListener=(e,s,t,o,r)=>Z(d+b,O(r),t,o,[e,s]),e.useResultCellListener=(e,s,t,o,r,u)=>Z(d+w,O(u),o,r,[e,s,t]),e.useResultRow=(e,s,t)=>Y(d+c,O(t),K,[e,s]),e.useResultRowCount=(e,s)=>Y(d+I,O(s),0,[e]),e.useResultRowCountListener=(e,s,t,o)=>Z(d+I,O(o),s,t,[e]),e.useResultRowIds=pe,e.useResultRowIdsListener=(e,s,t,o)=>Z(d+C,O(o),s,t,[e]),e.useResultRowListener=(e,s,t,o,r)=>Z(d+c,O(r),t,o,[e,s]),e.useResultSortedRowIds=we,e.useResultSortedRowIdsListener=(e,s,t,o,r,u,l,n)=>Z(d+p,O(n),u,l,[e,s,t,o,r]),e.useResultTable=(e,s)=>Y(d+n,O(s),K,[e]),e.useResultTableCellIds=(e,s)=>Y(d+n+b,O(s),J,[e]),e.useResultTableCellIdsListener=(e,s,t,o)=>Z(d+n+b,O(o),s,t,[e]),e.useResultTableListener=(e,s,t,o)=>Z(d+n,O(o),s,t,[e]),e.useRow=(e,s,t)=>Y(c,B(t),K,[e,s]),e.useRowCount=(e,s)=>Y(I,B(s),0,[e]),e.useRowCountListener=(e,s,t,o,r)=>Z(I,B(r),s,t,[e],o),e.useRowIds=te,e.useRowIdsListener=(e,s,t,o,r)=>Z(C,B(r),s,t,[e],o),e.useRowListener=(e,s,t,o,r,u)=>Z(c,B(u),t,o,[e,s],r),e.useSetCellCallback=(e,s,t,o,r,u,d,l)=>$(u,w,o,r,d,l,e,s,t),e.useSetCheckpointCallback=(e=y,s=J,t,o=y,r=J)=>{const u=Q(t);return G((s=>m(u,(t=>{const r=e(s);o(t.addCheckpoint(r),t,r)}))),[u,...s,...r])},e.useSetPartialRowCallback=(e,s,t,o,r,u,d)=>$(r,"PartialRow",t,o,u,d,e,s),e.useSetPartialValuesCallback=(e,s,t,o,r)=>$(t,"PartialValues",e,s,o,r),e.useSetRowCallback=(e,s,t,o,r,u,d)=>$(r,c,t,o,u,d,e,s),e.useSetTableCallback=(e,s,t,o,r,u)=>$(o,n,s,t,r,u,e),e.useSetTablesCallback=(e,s,t,o,r)=>$(t,i,e,s,o,r),e.useSetValueCallback=(e,s,t,o,r,u)=>$(o,R,s,t,r,u,e),e.useSetValuesCallback=(e,s,t,o,r)=>$(t,k,e,s,o,r),e.useSliceIds=ie,e.useSliceIdsListener=(e,s,t,o)=>Z("SliceIds",D(o),s,t,[e]),e.useSliceRowIds=ae,e.useSliceRowIdsListener=(e,s,t,o,r)=>Z("Slice"+C,D(r),t,o,[e,s]),e.useSortedRowIds=oe,e.useSortedRowIdsListener=(e,s,t,o,r,u,d,l,n)=>Z(p,B(n),u,d,[e,s,t,o,r],l),e.useStartTransactionListener=(e,s,t)=>Z("Start"+A,B(t),e,s),e.useStore=e=>v(e,0),e.useStoreIds=()=>q(1),e.useStoreOrStoreById=B,e.useTable=(e,s)=>Y(n,B(s),K,[e]),e.useTableCellIds=(e,s)=>Y(n+b,B(s),J,[e]),e.useTableCellIdsListener=(e,s,t,o,r)=>Z(n+b,B(r),s,t,[e],o),e.useTableIds=se,e.useTableIdsListener=(e,s,t,o)=>Z(a,B(o),e,s,J,t),e.useTableListener=(e,s,t,o,r)=>Z(n,B(r),s,t,[e],o),e.useTables=e=>Y(i,B(e),K),e.useTablesListener=(e,s,t,o)=>Z(i,B(o),e,s,J,t),e.useUndoInformation=e=>{const s=Q(e),[t,r]=ke(s);return[(u=t,!(0==u.length)),he(s),r,m(r,(e=>s?.getCheckpoint(e)))??o];var u},e.useValue=le,e.useValueIds=de,e.useValueIdsListener=(e,s,t,o)=>Z(g,B(o),e,s,J,t),e.useValueListener=(e,s,t,o,r)=>Z(R,B(r),s,t,[e],o),e.useValues=e=>Y(k,B(e),K),e.useValuesListener=(e,s,t,o)=>Z(k,B(o),e,s,J,t),e.useWillFinishTransactionListener=(e,s,t)=>Z("WillFinish"+A,B(t),e,s)},"object"==typeof exports&&"undefined"!=typeof module?s(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],s):s((e="undefined"!=typeof globalThis?globalThis:e||self).TinyBaseUiReact={},e.React);
